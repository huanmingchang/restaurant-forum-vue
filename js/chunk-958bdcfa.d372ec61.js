(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-958bdcfa"],{6135:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("AdminNav"),t.isLoading?n("Spinner"):n("table",{staticClass:"table"},[n("thead",{staticClass:"thead-dark"},[n("tr",[n("th",{attrs:{scope:"col"}},[t._v("#")]),n("th",{attrs:{scope:"col"}},[t._v("Email")]),n("th",{attrs:{scope:"col"}},[t._v("Role")]),n("th",{attrs:{scope:"col",width:"140"}},[t._v("Action")])])]),n("tbody",t._l(t.users,(function(e){return n("tr",{key:e.id},[n("th",{attrs:{scope:"row"}},[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.email))]),n("td",[t._v(t._s(e.isAdmin?"admin":"user"))]),n("td",[e.id!==t.currentUser.id&&e.isAdmin?n("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.toggleUserRole(e.id,e.isAdmin)}}},[t._v(" set as user ")]):t._e(),e.id===t.currentUser.id||e.isAdmin?t._e():n("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.toggleUserRole(e.id,e.isAdmin)}}},[t._v(" set as admin ")])])])})),0)])],1)},a=[],s=n("1da1"),i=n("5530"),c=(n("d9e2"),n("d81d"),n("96cf"),n("e04c")),o=n("2375"),u=n("be6c"),d=n("2fa3"),l=n("2f62"),m={name:"AdminUsers",components:{AdminNav:c["a"],Spinner:o["a"]},data:function(){return{users:[],isLoading:!0}},computed:Object(i["a"])({},Object(l["b"])(["currentUser"])),methods:{fetchUsers:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].users.get();case 3:n=e.sent,r=n.data,t.users=r.users,t.isLoading=!1,e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0),t.isLoading=!1,d["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))()},toggleUserRole:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.userId,a=t.isAdmin,n.prev=1,n.next=4,u["a"].users.update({userId:r,isAdmin:a});case 4:if(s=n.sent,c=s.data,"success"===c.status){n.next=8;break}throw new Error(c.message);case 8:e.users=e.users.map((function(t){return t.id===r?Object(i["a"])(Object(i["a"])({},t),{},{isAdmin:!t.isAdmin}):t})),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),console.log(n.t0),d["a"].fire({icon:"error",title:"無法切換使用者角色，請稍後再試"});case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()}},created:function(){this.fetchUsers()}},f=m,p=n("2877"),v=Object(p["a"])(f,r,a,!1,null,null,null);e["default"]=v.exports},be6c:function(t,e,n){"use strict";n("b0c0");var r=n("2fa3");e["a"]={categories:{get:function(){return r["b"].get("/admin/categories")},create:function(t){var e=t.name;return r["b"].post("/admin/categories",{name:e})},delete:function(t){var e=t.categoryId;return r["b"].delete("/admin/categories/".concat(e))},update:function(t){var e=t.categoryId,n=t.name;return r["b"].put("/admin/categories/".concat(e),{categoryId:e,name:n})}},restaurants:{create:function(t){var e=t.formData;return r["b"].post("/admin/restaurants",e)},getDetail:function(t){var e=t.restaurantId;return r["b"].get("/admin/restaurants/".concat(e))},get:function(){return r["b"].get("/admin/restaurants")},delete:function(t){var e=t.restaurantId;return r["b"].delete("/admin/restaurants/".concat(e))},update:function(t){var e=t.restaurantId,n=t.formData;return r["b"].put("/admin/restaurants/".concat(e),n)}},comments:{delete:function(t){var e=t.commentId;return r["b"].delete("/comments/".concat(e))}},users:{get:function(){return r["b"].get("/admin/users")},update:function(t){var e=t.userId,n=t.isAdmin;return r["b"].put("/admin/users/".concat(e),{isAdmin:n})}}}},d81d:function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").map,s=n("1dde"),i=s("map");r({target:"Array",proto:!0,forced:!i},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},e04c:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-3"},[n("h1",[t._v("餐廳後台")]),n("router-link",{attrs:{to:"/admin/restaurants"}},[t._v("Restaurants")]),t._v(" | "),n("router-link",{attrs:{to:"/admin/categories"}},[t._v("Categories")]),t._v(" | "),n("router-link",{attrs:{to:"/admin/users"}},[t._v("Users")])],1)},a=[],s={name:"AdminNav"},i=s,c=n("2877"),o=Object(c["a"])(i,r,a,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-958bdcfa.d372ec61.js.map